#Linux agent 
cd /tmp
wget https://github.com/glpi-project/glpi-agent/releases/download/1.11/glpi-agent_1.11-1_all.deb
sudo apt update
sudo apt install -y wget curl perl libwww-perl libjson-perl libnet-ssleay-perl libnet-cups-perl libproc-daemon-perl
sudo apt install libnet-ip-perl libnet-ssh2-perl libparse-edid-perl libparallel-forkmanager-perl libuniversal-require-perl libfile-which-perl libxml-libxml-perl libyaml-perl libtext-template-perl libcpanel-json-xs-perl libyaml-tiny-perl libsocket-getaddrinfo-perl libdata-uuid-perl libdbi-perl libdbd-mysql-perl
sudo dpkg -i glpi-agent_1.11-1_all.deb
glpi-agent --version
sudo chown -R www-data:www-data /var/www/glpi
sudo chmod -R 755 /var/www/glpi
sudo systemctl restart apache2
sudo systemctl enable glpi-agent
sudo systemctl start glpi-agent
sudo systemctl status glpi-agent
curl -v http://glpi.alphatech.local/glpi/front/inventory.php
sudo glpi-agent --server http://glpi.alphatech.local/glpi/front/inventory.php --debug
rm -rf ~/Téléchargements/GLPI-Agent-1.11.tar.gz

sudo nano /etc/apache2/sites-available/glpi.conf

<Directory /var/www/glpi/public>
    Require all granted
</Directory>

sudo systemctl reload apache2
sudo a2enmod rewrite proxy_fcgi
sudo systemctl reload apache2

sudo systemctl unmask glpi-agent
sudo systemctl enable glpi-agent
sudo systemctl start glpi-agent

sudo nano /etc/glpi-agent/agent.cfg
server = http://glpi.alphatech.local/glpi/front/inventory.php

sudo systemctl stop glpi-agent
sudo systemctl disable glpi-agent
sudo apt remove --purge glpi-agent -y
sudo rm -rf /etc/glpi-agent
sudo rm -rf /var/log/glpi-agent
sudo rm -rf /var/lib/glpi-agent
sudo find / -name "glpi-agent" 2>/dev/null


cd /var/log/glpi-agent
ls -l
sudo tail -f glpi-agent.log
sudo cat glpi-agent.log

sudo journalctl -u glpi-agent
sudo grep "server" /var/log/glpi-agent/glpi-agent.log

curl -v http://172.16.1.4/glpi/front/inventory.php
sudo glpi-agent --server http://172.16.1.4/glpi/front/inventory.php --debug


sudo nano /etc/apache2/sites-available/glpi.alphatech.local.conf

<VirtualHost *:80>
    ServerName glpi.alphatech.local
    DocumentRoot /var/www/glpi/public

    <Directory /var/www/glpi/public>
        Options FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>

    <FilesMatch "\.php$">
        SetHandler "proxy:unix:/run/php/php8.2-fpm.sock|fcgi://localhost/"
    </FilesMatch>
</VirtualHost>

sudo a2ensite glpi.alphatech.local.conf
sudo systemctl reload apache2

sudo nano /etc/php/8.2/apache2/php.ini

session.cookie_httponly = On
upload_max_filesize = 20M
post_max_size = 20M

sudo systemctl restart php8.2-fpm.service
sudo systemctl restart apache2


